<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>about.lua</title>
  <link rel="stylesheet" href="pycco.css">
<script src=https://polyfill.io/v3/polyfill.min.js?features=es6></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>DUO=Data Miners Using Optimizers </h1><h1>about.lua</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <a href=index.html>home</a> :: <a href=about.html>about</a> :: <a href=https://github.com/timm/lua/tree/master/test>examples</a> :: <a href=http://github.com/timm/lua>src</a> :: <a href=http://github.com/timm/lua/issues>discuss</a> :: <a href=https://github.com/timm/lua/blob/master/LICENSE.md>Â© 2020</a> by <a href=http://menzies.us>timm</a></p>
<hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>This file shows the conventions used in this code.</p>
<p><img align=right width=500 
 src="https://github.com/timm/lua/raw/master/etc/img/about.jpg"></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <h2>No Globals, all modules</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>All files are modules that usually start with <code>local X={}</code> and ends 
with <code>return X</code>.</p>
<p>Whenever my tests are run (see below),
the <code>rogues</code> function from <a href="ok.html">ok.lua</a>
warns about anything that has inappropriately escaped to the global space.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <h2>Optional Config</h2>
<p>The file <a href="the.html">the.lua</a> contains defaults that code can include using    </p>
<p><code>local THE=require("the")</code>.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <hr />
<h2>Test-Driven Development</h2>
<p>Most files in <code>src/X.lua</code> have unit test files <code>test/X.lua</code>. The unit tests files
patch the load path then load <code>src</code> files. For example, see right.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nb">package.path</span> <span class="o">=</span> <span class="s1">&#39;../src/?.lua;&#39;</span> <span class="o">..</span> <span class="nb">package.path</span>
<span class="nb">require</span> <span class="s2">&quot;lib&quot;</span>
<span class="kd">local</span> <span class="n">ok</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;ok&quot;</span><span class="p">)</span>

<span class="n">roguevar</span><span class="o">=</span><span class="mi">22</span> <span class="c1">-- this rogue global will generate a warning message</span>

<span class="n">ok</span><span class="p">{</span><span class="n">notok</span> <span class="o">=</span> <span class="kr">function</span><span class="p">()</span> <span class="nb">assert</span><span class="p">(</span><span class="mi">1</span><span class="o">~=</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;not eq&quot;</span><span class="p">)</span> <span class="kr">end</span><span class="p">}</span>
<span class="n">ok</span><span class="p">{</span><span class="n">ok</span> <span class="o">=</span> <span class="kr">function</span><span class="p">()</span> <span class="nb">assert</span><span class="p">(</span><span class="mi">1</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;not equal&quot;</span><span class="p">)</span> <span class="kr">end</span><span class="p">}</span>

<span class="n">o</span><span class="p">{</span><span class="n">aa</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bb</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cc</span><span class="o">=</span><span class="p">{</span><span class="n">dd</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">ee</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ff</span><span class="o">=</span><span class="p">{</span><span class="mi">10</span><span class="p">}}}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>My <code>ok</code> test engine (shown at right, defined in <a href="ok.html">ok.lua</a>)
accepts pairs <code>testName=function</code>, then
prints <code>testName</code>; then
runs the <code>function</code>.</p>
<p>If <code>function</code>
crashes, <code>ok</code> will just print the stack trace without terminating the program
(so having crashing code does not block other tests from executing).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <hr />
<h2>Gutless Objects</h2>
<p>My &ldquo;object-ish&rdquo; methods have no colon &ldquo;<code>:</code>&rdquo; operator.
Why kludge objects when Lua has such a clean module system? </p>
<p>Gutless supports encapsulation, polymorphism, constructors,
inheritance of instance variables (but not inheritance of methods).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>An example Gutless file is shown at right. 
I always use <code>i</code> to denote the receiver instance (analogous to the <code>self</code> convention of
Python or the <code>this</code> convention of Java).
In that example, <code>Object</code> and <code>Column</code> are classes
while <code>i</code> is an instance.
Note that that file:
start by defining a new class <code>local Column={is="Column"}</code>
and  includes the super class; e.g.    </p>
<p><code>local Object=require("Object")</code></p>
<p>The file also needs a constructor of <code>function Column.new(t)</code> where the table <code>t</code>
contains overrides to the defaults.
That constructor starts by calling <code>Object.new()</code> and
also  adds a point <code>i.me</code> back to the class.</p>
<p>this <code>i.me</code> pointer enables polymorphism.  to send
a <code>message</code>  back to an class with arguments <code>args</code> (and to
select the receiver based on
the type of the object), then call:       </p>
<p><code>i.me.message(i, args)</code></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kd">local</span> <span class="n">object</span><span class="o">=</span><span class="nb">require</span><span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">column</span><span class="o">=</span><span class="p">{</span><span class="n">is</span><span class="o">=</span><span class="s2">&quot;column&quot;</span><span class="p">}</span>

<span class="kr">function</span> <span class="nc">column</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="kd">local</span> <span class="n">i</span> <span class="o">=</span> <span class="n">object</span><span class="p">.</span><span class="n">new</span><span class="p">()</span> <span class="c1">-- begin standard creation stuff</span>
  <span class="n">i</span><span class="p">.</span><span class="n">me</span> <span class="o">=</span> <span class="n">Column</span>
  <span class="n">i</span><span class="p">.</span><span class="n">n</span>   <span class="o">=</span> <span class="mi">0</span>
  <span class="n">t</span>     <span class="o">=</span> <span class="n">t</span> <span class="ow">or</span> <span class="p">{}</span>
  <span class="n">i</span><span class="p">.</span><span class="n">txt</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">txt</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span> <span class="c1">-- begin stuff just for Column instances</span>
  <span class="n">i</span><span class="p">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">pos</span> <span class="ow">or</span> <span class="mi">0</span>
  <span class="n">i</span><span class="p">.</span><span class="n">w</span>   <span class="o">=</span> <span class="n">i</span><span class="p">.</span><span class="n">txt</span><span class="p">:</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="mi">1</span>
  <span class="n">i</span><span class="p">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">key</span> <span class="ow">or</span> <span class="kr">function</span> <span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="kr">return</span> <span class="n">z</span> <span class="kr">end</span>
  <span class="kr">return</span> <span class="n">i</span> <span class="c1">-- don&#39;t forget to return the new instance.</span>
<span class="kr">end</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <hr />
<p>And finally&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kr">return</span> <span class="n">Column</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
